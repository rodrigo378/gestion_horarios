<div *ngIf="turnoData" class="shadow-lg p-3 bg-white rounded-lg">
  <p class="text-2xl font-bold">
    Asignaci√≥n de horarios |
    {{ turnoData.n_ciclo }}¬∞ Ciclo -
    {{ turnoData.c_nommod }} -
    Secci√≥n {{ turnoData.c_grpcur }} -
    {{ turnoData.nomesp }}
  </p>
  <p class="text-slate-500 mt-1">Asigne horarios a los docentes:</p>
</div>

<div id="external-events" class="bg-white shadow-lg border p-5 rounded-xl mt-5">
  <h2 class="text-xl font-bold text-slate-800 mb-4 border-b border-slate-200 pb-2">
    üìö Cursos por Plan
  </h2>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    
    <!-- üìò Plan 2023 -->
    <div>
      <h3 class="text-lg font-semibold text-blue-600 mb-3">
        üìò Plan 2023 ({{ cursosPlan2023Visibles.length }} cursos)
      </h3>
      <div class="space-y-3">
        <div *ngFor="let curso of cursosPlan2023Visibles"
            class="fc-event bg-white shadow-sm border border-slate-200 rounded-lg px-4 py-2 cursor-move"
            [attr.data-event]="stringifyEvent(curso)">
          <p class="text-sm text-slate-800 font-medium">
            <span class="font-semibold">[{{ curso.c_codcur }}]</span> - {{ curso.c_nomcur }}
          </p>
          <p class="text-xs text-gray-600 mt-1">
            {{ curso.tipo }}: {{ curso.horasRestantes }} hrs
          </p>
          <p class="text-sm text-slate-800 font-medium mt-1">
            {{ curso.c_nommod }}
          </p>
        </div>
      </div>
    </div>

    <!-- üìó Plan 2025 -->
    <div>
      <h3 class="text-lg font-semibold text-green-600 mb-3">
        üìó Plan 2025 ({{ cursosPlan2025Visibles.length }} cursos)
      </h3>
      <div class="space-y-3">
        <div *ngFor="let curso of cursosPlan2025Visibles"
            class="fc-event bg-white shadow-sm border border-slate-200 rounded-lg px-4 py-2 cursor-move"
            [attr.data-event]="stringifyEvent(curso)">
          <p class="text-sm text-slate-800 font-medium">
            <span class="font-semibold">[{{ curso.c_codcur }}]</span> - {{ curso.c_nomcur }}
          </p>
          <p class="text-xs text-gray-600 mt-1">
            {{ curso.tipo }}: {{ curso.horasRestantes }} hrs
          </p>
          <p class="text-sm text-slate-800 font-medium mt-1">
            {{ curso.c_nommod }}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>


<div *ngIf="turnoData" class="shadow-lg p-3 bg-white rounded-lg mt-5">
  <p class="text-2xl font-bold">
    {{ turnoData.n_ciclo }}¬∞ Ciclo -
    {{ turnoData.c_nommod }} -
    Secci√≥n {{ turnoData.c_grpcur }} -
    {{ turnoData.nomesp }}
  </p>
</div>

<!-- üìÖ Calendario -->
<full-calendar  
  *ngIf="mostrarCalendario"
  #fullcalendar
  [options]="calendarOptions"
  class="mt-5 shadow-lg bg-white p-5 rounded-lg border border-gray-200">
</full-calendar>

<button
  (click)="guardarEventos()"
  class="mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
  üíæ Guardar horarios
</button>

<div *ngIf="modalHorasActivo" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md text-center">
    <h2 class="text-lg font-semibold mb-3">
      {{ eventoSeleccionado ? 'Editar horario de:' : 'Asignar horario a:' }}
    </h2>
    
    <!-- Curso (bloqueado) -->
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700">Curso</label>
      <select class="w-full border rounded px-3 py-1" disabled>
        <option>
          {{ cursoSeleccionado?.extendedProps?.codigo }} - {{ cursoSeleccionado?.title }}
        </option>
      </select>
    </div>

    <!-- D√≠a editable -->
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700">D√≠a</label>
      <select class="w-full border rounded px-3 py-1" [(ngModel)]="diaSeleccionado">
        <option *ngFor="let dia of ['Lunes','Martes','Mi√©rcoles','Jueves','Viernes','S√°bado']">{{ dia }}</option>
      </select>
    </div>

    <!-- Hora inicio -->
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700">Hora de inicio</label>
      <input type="time" class="w-full border rounded px-3 py-1" [(ngModel)]="horaInicio">
    </div>

    <!-- N¬∞ de horas -->
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700">
        Asignar horas - M√°ximo {{ cursoSeleccionado?.horasDisponibles }} horas
      </label>
      <input type="number"
            [(ngModel)]="horasAsignadas"
            [max]="cursoSeleccionado?.horasDisponibles"
            min="1"
            class="w-full border rounded px-3 py-1 text-center">
    </div>

    <!-- Aula -->
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700">Aula</label>
      <select class="w-full border rounded px-3 py-1" [(ngModel)]="aulaSeleccionada">
        <option *ngFor="let aula of aulas" [value]="aula.id">{{ aula.nombre }}</option>
      </select>
    </div>

    <!-- Docente -->
    <div class="mb-3">
      <label class="block text-sm font-medium text-gray-700">Docente</label>
      <select class="w-full border rounded px-3 py-1" [(ngModel)]="docenteSeleccionado">
        <option *ngFor="let docente of docentes" [value]="docente.id">
          {{ docente.nombre }}
        </option>
      </select>
    </div>

    <!-- Botones -->
    <div class="mt-4 flex flex-wrap justify-center gap-3">
      <!-- Bot√≥n de asignar o actualizar -->
      <button *ngIf="!eventoSeleccionado"
              (click)="confirmarAsignacionHoras()"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        ‚ûï Asignar
      </button>

      <button *ngIf="eventoSeleccionado"
              (click)="actualizarEvento()"
              class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
        üîÑ Actualizar
      </button>

      <!-- Bot√≥n eliminar -->
      <button *ngIf="eventoSeleccionado"
              (click)="eliminarEvento()"
              class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
        üóëÔ∏è Eliminar
      </button>

      <!-- Cancelar -->
      <button (click)="cancelarAsignacionHoras()"
              class="bg-gray-300 px-4 py-2 rounded hover:bg-gray-400">
        ‚ùå Cancelar
      </button>
    </div>
  </div>
</div>
