<!-- component -->
<div class="max-w-[100%] mx-auto">
  <div
    class="relative flex flex-col w-full h-full text-slate-700 bg-white shadow-md rounded-xl bg-clip-border"
  >
    <div
      class="relative mx-4 mt-4 overflow-hidden text-slate-700 bg-white rounded-none bg-clip-border"
    >
      <div class="flex items-center justify-between">
        <div>
          <h3 class="text-lg font-semibold text-slate-800">Agrupar cursos</h3>
        </div>
        <div class="flex flex-col gap-2 shrink-0 sm:flex-row">
          <div class="w-full md:w-72">
            <div class="relative h-10 w-full min-w-[200px]">
              <div
                class="absolute grid w-5 h-5 top-2/4 right-3 -translate-y-2/4 place-items-center text-blue-gray-500"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-5 h-5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"
                  ></path>
                </svg>
              </div>
              <input
                [(ngModel)]="filtroBusqueda"
                (ngModelChange)="buscarDesdeInput()"
                class="peer h-full w-full rounded-[7px] border border-blue-gray-200 bg-transparent px-3 py-2.5 !pr-9 font-sans text-sm font-normal text-blue-gray-700 outline outline-0 transition-all placeholder-shown:border placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 focus:border-2 focus:border-gray-900 focus:border-t-transparent focus:outline-0 disabled:border-0 disabled:bg-blue-gray-50"
                placeholder=" "
              />
              <label
                class="before:content[' '] after:content[' '] pointer-events-none absolute left-0 -top-1.5 flex h-full w-full select-none !overflow-visible truncate text-[11px] font-normal leading-tight text-gray-500 transition-all before:pointer-events-none before:mt-[6.5px] before:mr-1 before:box-border before:block before:h-1.5 before:w-2.5 before:rounded-tl-md before:border-t before:border-l before:border-blue-gray-200 before:transition-all after:pointer-events-none after:mt-[6.5px] after:ml-1 after:box-border after:block after:h-1.5 after:w-2.5 after:flex-grow after:rounded-tr-md after:border-t after:border-r after:border-blue-gray-200 after:transition-all peer-placeholder-shown:text-sm peer-placeholder-shown:leading-[3.75] peer-placeholder-shown:text-blue-gray-500 peer-placeholder-shown:before:border-transparent peer-placeholder-shown:after:border-transparent peer-focus:text-[11px] peer-focus:leading-tight peer-focus:text-gray-900 peer-focus:before:border-t-2 peer-focus:before:border-l-2 peer-focus:before:!border-gray-900 peer-focus:after:border-t-2 peer-focus:after:border-r-2 peer-focus:after:!border-gray-900 peer-disabled:text-transparent peer-disabled:before:border-transparent peer-disabled:after:border-transparent peer-disabled:peer-placeholder-shown:text-blue-gray-500"
              >
                Search
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="flex justify-start items-center flex-wrap gap-3 mt-4 mb-4 mr-4">
      <select
        class="px-4 py-2 text-sm rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none w-28"
        [(ngModel)]="selectFacultadad"
        (change)="changeSelectFacultad()"
      >
        <option value="">Facultad</option>
        <option value="S">CIENCIAS DE LA SALUD</option>
        <option value="E">INGENIERÍA Y NEGOCIOS</option>
      </select>

      <!-- Select: Especialidad -->
      <select
        class="px-4 py-2 text-sm rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none w-96"
        [(ngModel)]="selectEspecialidad"
      >
        <option value="">Especialidad</option>
        <option
          *ngFor="let especialidad of especialidades"
          [value]="especialidad.codesp"
        >
          {{ especialidad.nomesp }}
        </option>
      </select>

      <!-- Select: Modalidad -->
      <select
        class="px-4 py-2 text-sm rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none w-28"
        [(ngModel)]="selectModalidad"
      >
        <option value="">Modalidad</option>
        <option value="1">Presencial</option>
        <option value="2">Semipresencial</option>
        <option value="3">Virtual</option>
      </select>

      <select
        class="px-4 py-2 text-sm rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none w-28"
        [(ngModel)]="selectPlan"
      >
        <option value="2023">2023</option>
        <option value="2025">2025</option>
      </select>

      <select
        class="px-4 py-2 text-sm rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none w-28"
        [(ngModel)]="selectCiclo"
      >
        <option value="">Ciclo</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
      </select>

      <select
        class="px-4 py-2 text-sm rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none w-28"
        [(ngModel)]="selectPeriodo"
      >
        @for (periodo of periodos; track periodo.n_codper) {
        <option value="{{ periodo.n_codper }}">{{ periodo.n_codper }}</option>
        }
      </select>
    </div>

    <div class="flex justify-start items-center flex-wrap gap-3 mt-4 mb-4 mr-4">
      <button
        class="flex items-center gap-2 bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white font-semibold py-2 px-5 rounded-xl shadow-lg transition-all duration-300"
        (click)="clickDefinirCursoTransversales()"
      >
        <i class="fa-solid fa-plus"></i>
        Definir Cursos Agrupados
      </button>
    </div>

    <div class="p-0 overflow-scroll">
      <table class="w-full mt-4 text-left table-auto min-w-max">
        <thead>
          <tr>
            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Turno Plan
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>
            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Curso Plan
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>
            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Facultad
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>
            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Especialidad
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>

            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Curso
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>

            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Docente
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>

            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Seccion
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>

            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Ciclo
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>

            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Acciónes
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>

            <th
              class="p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100"
            >
              <p
                class="flex items-center justify-between gap-2 font-sans text-sm font-normal leading-none text-slate-500"
              >
                Agrupados
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  aria-hidden="true"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"
                  ></path>
                </svg>
              </p>
            </th>
          </tr>
        </thead>
        <tbody>
          @for (curso of cursos; track curso.id) {
          <!-- curso.cursosPadres[0].tipo === 0 -->
          <tr
            *ngIf="
              curso.cursosPadres.length === 0 ||
              (curso.cursosPadres[0].padre_curso_id === curso.id &&
                curso.cursosPadres[0].tipo !== 0)
            "
          >
            <!-- columnas del curso -->
            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  <p class="text-sm font-semibold text-slate-700">
                    <!-- turno.id => {{ curso.turno.id }} <br /> -->
                    <!-- turno.n_codper => {{ curso.turno.n_codper }} <br /> -->
                    <!-- turno.n_codpla =>  -->
                    {{ curso.turno.n_codpla }}<br />
                    <!-- curso.n_codper => {{ curso.n_codper }} <br /> -->
                    <!-- curso.c_codmod => {{ curso.c_codmod }} <br /> -->
                  </p>
                </div>
              </div>
            </td>
            <!-- columnas del curso -->
            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  <p class="text-sm font-semibold text-slate-700">
                    <!-- turno.id => {{ curso.turno.id }} <br /> -->
                    <!-- turno.n_codper => {{ curso.turno.n_codper }} <br /> -->
                    <!-- turno.n_codpla =>  -->
                    {{ curso.n_codper }}<br />
                    <!-- curso.n_codper => {{ curso.n_codper }} <br /> -->
                    <!-- curso.c_codmod => {{ curso.c_codmod }} <br /> -->
                  </p>
                </div>
              </div>
            </td>

            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  <p class="text-sm font-semibold text-slate-700">
                    {{ curso.nom_fac }}
                  </p>
                </div>
              </div>
            </td>

            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  <p class="text-sm font-semibold text-slate-700">
                    {{ curso.nomesp }}
                  </p>
                </div>
              </div>
            </td>

            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  <p class="text-sm font-semibold text-slate-700">
                    <a
                      [href]="'/coa/asignarhorario?id=' + curso.turno_id"
                      target="_blank"
                      rel="noopener noreferrer"
                      style="text-decoration: underline; cursor: pointer"
                    >
                      ({{ curso.c_codcur }}) {{ curso.c_nomcur }} <br />
                    </a>
                  </p>
                  <p>
                    ({{
                      curso.c_codmod === 1
                        ? "Presencial"
                        : curso.c_codmod === 2
                        ? "Semipresencial"
                        : "virtual"
                    }})
                  </p>
                </div>
              </div>
            </td>

            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  @if (curso.Horario.length !== 0) { @for (horario of
                  curso.Horario; track horario.id) {
                  <p class="text-sm font-semibold text-slate-700">
                    {{ horario.Docente?.c_nomdoc || "sin docente" }}
                    ({{ horario.dia }})
                    {{ horario.h_inicio | date : "shortTime" }} -
                    {{ horario.h_fin | date : "shortTime" }}
                  </p>
                  } } @else {
                  <p class="text-sm font-semibold text-slate-700">
                    Sin asignar
                  </p>
                  }
                </div>
              </div>
            </td>
            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  <p class="text-sm font-semibold text-slate-700">
                    {{ curso.turno.c_grpcur }}
                  </p>
                </div>
              </div>
            </td>
            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  <p class="text-sm font-semibold text-slate-700">
                    {{ curso.turno.n_ciclo }}
                  </p>
                </div>
              </div>
            </td>

            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center justify-center gap-2">
                @if (curso.cursosPadres.length === 0) {
                <!-- Botón agregar -->
                <button
                  class="relative h-10 w-10 rounded-lg text-green-600 hover:bg-green-600/10 active:bg-green-600/20 transition-all"
                  type="button"
                  (click)="
                  curso.vencio ? mostrarAlertaVencido() : clickMas(curso)"
                >
                  <span
                    class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"
                  >
                    <i class="fa-solid fa-plus fa-lg"></i>
                  </span>
                </button>
                } @if (curso.cursosPadres.length !== 0) {
                <!-- Botón eliminar -->
                <button
                  class="relative h-10 w-10 rounded-lg text-red-600 hover:bg-red-600/10 active:bg-red-600/20 transition-all"
                  type="button"
                  (click)="
                  curso.vencio
                  ? mostrarAlertaVencido()
                  : confirmarEliminacionTransversal(curso.id)"
                >
                  <span
                    class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"
                  >
                    <i class="fa-solid fa-trash fa-lg"></i>
                  </span>
                </button>
                }
              </div>
            </td>

            <td class="p-4 border-b border-slate-200">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  @for (hijo of curso.cursosHijos; track hijo.id) { @if
                  (curso.id !== hijo.cursosHijo.id) {
                  <p class="text-sm font-semibold text-slate-700">
                    <a
                      *ngIf="hijo.cursosHijo && hijo.cursosHijo.turno"
                      [href]="
                        '/coa/asignarhorario?id=' + hijo.cursosHijo.turno_id
                      "
                      target="_blank"
                      rel="noopener noreferrer"
                      style="text-decoration: underline; cursor: pointer"
                    >
                      ({{ hijo.cursosHijo.n_codper }})
                      {{ hijo.cursosHijo.c_codcur }} -
                      {{ hijo.cursosHijo.turno.c_grpcur }}
                      ({{ hijo.cursosHijo.c_codfac }} -
                      {{ hijo.cursosHijo.c_codesp }})
                    </a>
                  </p>
                  } }
                </div>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    <div class="flex items-center justify-between px-4 py-3">
      <div class="flex items-center gap-3">
        <p class="text-sm text-slate-600">
          Página {{ paginaActual }} de
          {{ totalCursos ? Math.ceil(totalCursos / itemsPorPagina) : 1 }} —
          Total: {{ totalCursos }} cursos
        </p>

        <!-- SELECT de ítems por página -->
        <select
          class="border border-slate-300 text-sm rounded px-5 py-1 text-slate-600"
          [(ngModel)]="itemsPorPagina"
          (change)="cambiarItemsPorPagina(itemsPorPagina)"
        >
          <option [value]="10">10</option>
          <option [value]="20">20</option>
          <option [value]="50">50</option>
          <option [value]="100">100</option>
          <option [value]="200">200</option>
          <option [value]="300">300</option>
          <option [value]="500">500</option>
          <option [value]="5000">Todos</option>
        </select>
      </div>

      <div class="flex gap-2">
        <button
          class="rounded border border-slate-300 py-2 px-3 text-xs font-semibold text-slate-600 transition-all hover:opacity-75 disabled:opacity-50"
          [disabled]="paginaActual === 1"
          (click)="retrocederPagina()"
        >
          Anterior
        </button>
        <button
          class="rounded border border-slate-300 py-2 px-3 text-xs font-semibold text-slate-600 transition-all hover:opacity-75 disabled:opacity-50"
          [disabled]="paginaActual === Math.ceil(totalCursos / itemsPorPagina)"
          (click)="avanzarPagina()"
        >
          Siguiente
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div
  *ngIf="mostrarModalCrear"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
>
  <div
    class="bg-white p-6 rounded-xl shadow-xl w-full max-w-5xl h-[37rem] overflow-y-auto"
  >
    <!-- Cabecera -->
    <div class="flex justify-between items-center mb-4">
      <div>
        <h2 class="text-xl font-bold text-gray-800">
          Definir curso transversal
        </h2>
        <p class="text-sm text-gray-600">
          <span class="font-semibold">id:</span> {{ curso.turno.id }}
          <br />
          <span class="font-semibold">Código:</span> {{ curso.c_codcur }}
          <br />
          <span class="font-semibold">Nombre:</span> {{ curso.c_nomcur }}
          <br />
          <span class="font-semibold">Facultad:</span> {{ curso.c_codfac }}
          <br />
          <span class="font-semibold">Especialidad:</span> {{ curso.c_codesp }}
          <br />
          <span class="font-semibold">Ciclo:</span> {{ curso.n_ciclo }}
          <br />
          <span class="font-semibold">Modadlidad:</span>
          {{
            curso.c_codmod === 1
              ? "Presencial"
              : curso.c_codmod === 2
              ? "Semipresencial"
              : "virtual"
          }}
          <br />
          <span class="font-semibold">Grupo:</span> {{ curso.turno.c_grpcur }}
        </p>
      </div>
      <button class="text-gray-500 hover:text-red-500" (click)="cerrarModal()">
        <i class="fa-solid fa-xmark text-xl"></i>
      </button>
    </div>

    <!-- Filtros -->
    <form class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6">
      <!-- Modalidad -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1"
          >Modalidad</label
        >
        <select
          [(ngModel)]="filtros.c_codmod"
          name="modalidad"
          class="w-full border-gray-300 rounded-md px-3 py-2"
        >
          <option value="">Seleccione modalidad</option>
          <option value="1">Presencial</option>
          <option value="2">Semipresencial</option>
          <option value="3">Virtual</option>
        </select>
      </div>

      <!-- Facultad -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1"
          >Facultad</label
        >
        <select
          [(ngModel)]="filtros.c_codfac"
          (change)="changeSelectFacultadModal()"
          name="facultad"
          class="w-full border border-gray-300 rounded-md px-3 py-2"
        >
          <option value="">Seleccione facultad</option>
          <option value="S">Ciencias de la Salud</option>
          <option value="E">Ingeniería y Negocios</option>
        </select>
      </div>

      <!-- Especialidad -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1"
          >Especialidad</label
        >
        <select
          [(ngModel)]="filtros.c_codesp"
          name="especialidad"
          class="w-full border border-gray-300 rounded-md px-3 py-2"
        >
          <option value="">Seleccione especialidad</option>
          <option *ngFor="let esp of especialidadesModal" [value]="esp.codesp">
            {{ esp.nomesp }}
          </option>
        </select>
      </div>

      <!-- Plan -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Plan</label>
        <select
          [(ngModel)]="filtros.n_codper"
          name="n_codper"
          class="w-full border border-gray-300 rounded-md px-3 py-2"
        >
          <option value="">Seleccione Plan</option>
          <option value="2023">2023</option>
          <option value="2025">2025</option>
        </select>
      </div>

      <!-- Ciclo -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1"
          >Ciclo</label
        >
        <select
          [(ngModel)]="filtros.n_ciclo"
          name="n_ciclo"
          class="w-full border border-gray-300 rounded-md px-3 py-2"
        >
          <option value="0">Seleccione Ciclo</option>
          <option
            *ngFor="let ciclo of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"
            [value]="ciclo"
          >
            {{ ciclo }}
          </option>
        </select>
      </div>

      <!-- Filtro de búsqueda -->
      <div class="col-span-full md:col-span-2">
        <label class="block text-sm font-medium text-gray-700 mb-1"
          >Buscar</label
        >
        <input
          type="text"
          [(ngModel)]="filtros.busqueda"
          name="filtroBusqueda"
          placeholder="Buscar por nombre o código de curso"
          class="w-full border border-gray-300 rounded-md px-3 py-2"
        />
      </div>

      <!-- Botón de búsqueda -->
      <div class="flex items-end">
        <button
          class="w-full px-4 py-2 bg-blue-700 text-white rounded hover:bg-blue-800"
          (click)="clickBuscarCursosModal()"
        >
          Buscar
        </button>
      </div>
    </form>

    <!-- Tabla -->

    <div
      *ngIf="busquedaEjecutada && cargandoCursos"
      class="flex justify-center items-center h-[300px] w-full"
    >
      <div class="flex flex-col items-center gap-2">
        <img
          src="assets/img/logo-uma.png"
          alt="Cargando UMA"
          class="w-20 h-20 animate-spin"
        />
        <span class="text-sm text-gray-600 mt-2"
          >Cargando cursos disponibles...</span
        >
      </div>
    </div>

    <div *ngIf="busquedaEjecutada && !cargandoCursos">
      <h3 class="text-md font-semibold text-gray-700 mb-2">
        Seleccionar curso
      </h3>
      @if (cursosFiltrados.length !== 0) {
      <div class="flex justify-end mb-2">
        <button
          class="px-3 py-1 text-sm font-medium text-white bg-blue-700 rounded hover:bg-blue-800 transition"
          (click)="toggleSeleccionarTodos()"
        >
          {{ todosSeleccionados ? "Deseleccionar todos" : "Seleccionar todos" }}
        </button>
      </div>
      }
      <div class="overflow-auto max-h-64 border rounded-md">
        <table class="min-w-full text-sm text-left text-gray-700">
          <thead class="bg-gray-100">
            <tr>
              <th class="px-4 py-2">Facultad</th>
              <th class="px-4 py-2">Especialidad</th>
              <th class="px-4 py-2">Cod Plan</th>
              <th class="px-4 py-2">Curso</th>
              <th class="px-4 py-2">Sección</th>
              <th class="px-4 py-2">Ciclo</th>
              <th class="px-4 py-2">Seleccionar</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let curso of cursosFiltrados">
              <tr class="border-t">
                <td class="px-4 py-2">
                  <!-- turno.id => {{ curso.turno.id }} <br /> -->
                  <!-- turno.n_codper => {{ curso.turno.n_codper }} <br /> -->
                  <!-- turno.n_codpla =>  -->
                  {{ curso.turno.n_codpla }}<br />
                  <!-- curso.n_codper => {{ curso.n_codper }} -->
                </td>

                <td class="px-4 py-2">
                  {{ curso.nomesp }}
                </td>
                <td class="px-4 py-2">{{ curso.n_codper }}</td>
                <td class="px-4 py-2">
                  ({{ curso.c_codcur }}) {{ curso.c_nomcur }} <br />
                  (
                  {{
                    curso.c_codmod === 1
                      ? "Presencial"
                      : curso.c_codmod === 2
                      ? "Semipresencial"
                      : "virtual"
                  }}
                  )
                </td>
                <td class="px-4 py-2">{{ curso.turno.c_grpcur }}</td>
                <td class="px-4 py-2">{{ curso.n_ciclo }}</td>
                <td class="px-4 py-2 text-center align-middle">
                  <input
                    type="checkbox"
                    [checked]="estaSeleccionado(curso.id)"
                    (change)="toggleSeleccionCurso(curso)"
                    class="form-checkbox h-4 w-4 text-blue-600"
                  />
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Botones -->
    <div class="mt-6 flex justify-end gap-2">
      <button
        (click)="cerrarModal()"
        class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"
      >
        Cancelar
      </button>
      <button
        [disabled]="arrayCheckboxCursos.length === 0"
        (click)="clickGuardarModal()"
        class="px-4 py-2 bg-blue-700 text-white rounded hover:bg-blue-800"
      >
        Guardar
      </button>
    </div>
  </div>
</div>
